/*!
 * Éditeur Principal / Principal Publisher
 * wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html
 * Mis à jour le : 2022-02-18
 */
$("a.fn-lnk").each(function(t){var e=$(this).attr("href").replace("#",""),n=$(this).parent();$("sup[id='"+e+"-0-rf']").length?n.attr("id",e+"-"+t+"-rf"):n.attr("id",e+"-0-rf")}),function(t){"use strict";t.Granite=t.Granite||{},t.Granite.csrf||(t.Granite.csrf=function(){"use strict";function t(){this._handler=[]}function r(t){var e=document.location.host;var n=document.location.protocol;var r="//"+e;var i=n+r;return t===i||t.slice(0,i.length+1)===i+"/"||(t===r||t.slice(0,r.length+1)===r+"/")||!/^(\/\/|http:|https:).*/.test(t)}t.prototype={then:function(t,e){this._handler.push({resolve:t,reject:e})},resolve:function(){this._execute("resolve",arguments)},reject:function(){this._execute("reject",arguments)},_execute:function(n,r){if(this._handler===null)throw new Error("Promise already completed.");for(var t=0,e=this._handler.length;t<e;t++)this._handler[t][n].apply(window,r);this.then=function(t,e){(n==="resolve"?t:e).apply(window,r)};this._handler=null}};var i=":cq_csrf_token",o="CSRF-Token",a="/libs/granite/csrf/token.json",s,c;function u(t){if(window.console)console.warn("CSRF data not available;"+"The data may be unavailable by design, such as during non-authenticated requests: "+t)}function e(){var e=new t;s=e;var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===4)try{var t=JSON.parse(n.responseText);c=t.token;e.resolve(c)}catch(t){u(t);e.reject(n.responseText)}};n.open("GET",a,true);n.send();return e}function p(){var t=new XMLHttpRequest;t.open("GET",a,false);t.send();try{return c=JSON.parse(t.responseText).token}catch(t){u(t)}}function n(){c=void 0,e()}function l(t){var e=t.getAttribute("action");if(t.method.toUpperCase()==="GET"||e&&!r(e))return;if(!c)p();if(!c)return;var n=t.querySelector('input[name="'+i+'"]');if(!n){n=document.createElement("input");n.setAttribute("type","hidden");n.setAttribute("name",i);t.appendChild(n)}n.setAttribute("value",c)}function f(t){var e=function(t){var e=t.target;if(e.nodeName==="FORM")l(e)};if(t.addEventListener)t.addEventListener("submit",e,true);else if(t.attachEvent)t.attachEvent("submit",e)}f(document);var h=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,e,n){if(t.toLowerCase()!=="get"&&r(e)){this._csrf=true;this._async=n}return h.apply(this,arguments)};var d=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){if(!this._csrf){d.apply(this,arguments);return}if(c){this.setRequestHeader(o,c);d.apply(this,arguments);return}if(this._async===false){p();if(c)this.setRequestHeader(o,c);d.apply(this,arguments);return}var e=this;var n=Array.prototype.slice.call(arguments);s.then(function(t){e.setRequestHeader(o,t);d.apply(e,n)},function(){d.apply(e,n)})};var v=HTMLFormElement.prototype.submit;if(HTMLFormElement.prototype.submit=function(){l(this);return v.apply(this,arguments)},window.Node){var y=Node.prototype.appendChild;Node.prototype.appendChild=function(){var e=y.apply(this,arguments);if(e.nodeName==="IFRAME")try{if(e.contentWindow&&!e._csrf){e._csrf=true;f(e.contentWindow.document)}}catch(t){if(e.src&&e.src.length&&r(e.src))if(window.console)console.error("Unable to attach CSRF token to an iframe element on the same origin")}return e}}return e(),setInterval(function(){e()},3e5),{initialised:!1,refreshToken:e,_clearToken:function(){c=void 0,e()}}}())}(window);