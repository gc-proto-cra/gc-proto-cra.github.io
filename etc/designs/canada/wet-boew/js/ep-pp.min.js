/*!
 * Ã‰diteur Principal / Principal Publisher
 * wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html
 * Mis Ã  jour le : 2025-01-29
 */ $("a.fn-lnk").each(function(e){var t=$(this).attr("href").replace("#",""),n=$(this).parent();$("sup[id='"+t+"-0-rf']").length?n.attr("id",t+"-"+e+"-rf"):n.attr("id",t+"-0-rf")}),function(e,t){"use strict";t.Granite=t.Granite||{},!t.Granite.csrf&&(t.Granite.csrf=e())}(function(){"use strict";function e(){this._handler=[]}function t(e){var t=document.location.host,n=document.location.protocol,r="//"+t,a=n+r;return e===a||e.slice(0,a.length+1)===a+"/"||e===r||e.slice(0,r.length+1)===r+"/"||!/^(\/\/|http:|https:).*/.test(e)}e.prototype={then:function(e,t){this._handler.push({resolve:e,reject:t})},resolve:function(){this._execute("resolve",arguments)},reject:function(){this._execute("reject",arguments)},_execute:function(e,t){if(null===this._handler)throw Error("Promise already completed.");for(var n=0,r=this._handler.length;n<r;n++)this._handler[n][e].apply(window,t);this.then=function(n,r){("resolve"===e?n:r).apply(window,t)},this._handler=null}};var n,r,a=":cq_csrf_token",o="CSRF-Token",s="/libs/granite/csrf/token.json";function i(e){window.console&&console.warn("CSRF data not available;The data may be unavailable by design, such as during non-authenticated requests: "+e)}function u(){var t=new e;n=t;var a=new XMLHttpRequest;return a.onreadystatechange=function(){if(4===a.readyState)try{r=JSON.parse(a.responseText).token,t.resolve(r)}catch(e){i(e),t.reject(a.responseText)}},a.open("GET",s,!0),a.send(),t}function c(){var e=new XMLHttpRequest;e.open("GET",s,!1),e.send();try{return r=JSON.parse(e.responseText).token}catch(t){i(t)}}function p(e){var n=e.getAttribute("action");if("GET"!==e.method.toUpperCase()&&(!n||t(n))){if(r||c(),r){var o=e.querySelector('input[name="'+a+'"]');o||((o=document.createElement("input")).setAttribute("type","hidden"),o.setAttribute("name",a),e.appendChild(o)),o.setAttribute("value",r)}}}function l(e){var t=function(e){var t=e.target;"FORM"===t.nodeName&&p(t)};e.addEventListener?e.addEventListener("submit",t,!0):e.attachEvent&&e.attachEvent("submit",t)}l(document);var h=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(e,n,r){return"get"!==e.toLowerCase()&&t(n)&&(this._csrf=!0,this._async=r),h.apply(this,arguments)};var d=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){if(!this._csrf){d.apply(this,arguments);return}if(r){this.setRequestHeader(o,r),d.apply(this,arguments);return}if(!1===this._async){c(),r&&this.setRequestHeader(o,r),d.apply(this,arguments);return}var e=this,t=Array.prototype.slice.call(arguments);n.then(function(n){e.setRequestHeader(o,n),d.apply(e,t)},function(){d.apply(e,t)})};var f=HTMLFormElement.prototype.submit;if(HTMLFormElement.prototype.submit=function(){return p(this),f.apply(this,arguments)},window.Node){var y=Node.prototype.appendChild;Node.prototype.appendChild=function(){var e=y.apply(this,arguments);if("IFRAME"===e.nodeName)try{e.contentWindow&&!e._csrf&&(e._csrf=!0,l(e.contentWindow.document))}catch(n){e.src&&e.src.length&&t(e.src)&&window.console&&console.error("Unable to attach CSRF token to an iframe element on the same origin")}return e}}return u(),setInterval(function(){u()},3e5),{initialised:!1,refreshToken:u,_clearToken:function e(){r=void 0,u()}}},window),document.addEventListener("DOMContentLoaded",function(){var e=["/gc/services/generateemail","/gc/services/notify","https://apps.canada.ca"];document.addEventListener("submit",function(t){var n,r=t.target;"FORM"===r.tagName&&(n=r.action,e.some(e=>n.includes(e)))&&Array.from(r.elements).filter(function(e){return"textarea"===e.tagName.toLowerCase()||"input"===e.tagName.toLowerCase()&&["text","search"].includes(e.type)}).forEach(function(e){var t=e.value;if(t){var n=t.replace(/;/g,",");e.value=n}})},!0)}),function(e,t){"use strict";e.querySelector(".gcweb-menu > h2 + button + button + ul[role=menu]")&&t(".gcweb-menu > h2 + button").remove(),e.querySelector("[lang=fr] .gcweb-menu > h2 + ul[role=menu]")&&t(".gcweb-menu > h2").after('<button type="button" aria-haspopup="true" aria-expanded="false" aria-label="Menu principal. Appuyez sur la barre d\'espacement pour ouvrir ou sur la touche d\'\xe9chappement pour fermer le menu. Utilisez les fl\xe8ches haut et bas pour choisir un \xe9l\xe9ment de sous-menu. Appuyez sur la touche Entr\xe9e ou sur la fl\xe8che vers la droite pour le d\xe9velopper, ou sur la fl\xe8che vers la gauche ou la touche \xc9chap pour le r\xe9duire. Utilisez les fl\xe8ches haut et bas pour choisir un \xe9l\xe9ment de ce niveau et la touche Entr\xe9e pour y acc\xe9der.">Menu<span class="wb-inv"> principal</span> <span class="expicon glyphicon glyphicon-chevron-down"></span></button>'),e.querySelector("[lang=en] .gcweb-menu > h2 + ul[role=menu]")&&t(".gcweb-menu > h2").after('<button type="button" aria-haspopup="true" aria-expanded="false" aria-label="Main Menu. Press the SPACEBAR to expand or the escape key to collapse this menu. Use the Up and Down arrow keys to choose a submenu item. Press the Enter or Right arrow key to expand it, or the Left arrow or Escape key to collapse it. Use the Up and Down arrow keys to choose an item on that level and the Enter key to access it."><span class="wb-inv">Main </span>Menu <span class="expicon glyphicon glyphicon-chevron-down"></span></button>')}(document,jQuery);
